{
    "contents" : "print(\"DAU: PLYM1\")\nprint(\"Author: Andy Wills\")\nprint(\"Date: 2014-11-20\")\nlibrary(psych)\ncde <- read.table(\"plym1code.txt\", header = TRUE, sep = \"\\t\")\nbigdta <- read.table(\"plym1data.txt\", header = TRUE, sep = \"\\t\")\ndta <- subset(bigdta, phase == 1)\nppts <- 80\ntrls <- 96\nprint(\"Preparing response set analysis...\")\nbigm <- array(0, dim=c(ppts,11))\ncolnames(bigm) <- c(\"cond\",\"subj\",\"bright\",\"size\",\"os\",\"ident\",\"left1\",\"mid2\",\"right3\",\"model\",\"consist\")\no <- 0\nfor (j in 1:ppts) {\n\tmdl <-c(0,0,0,0,0,0,0)\n\ttio <-0\n\tfor (i in 1:trls) { \n\t\tif (cde[dta[i+o,'stim'],'bright'] == dta[i+o,'resp']) mdl[1] = mdl[1] + 1\n\t\tif (cde[dta[i+o,'stim'],'size'] == dta[i+o,'resp']) mdl[2] = mdl[2] + 1\n\t\tif (cde[dta[i+o,'stim'],'os'] == dta[i+o,'resp']) mdl[3] = mdl[3] + 1\n\t\tif (cde[dta[i+o,'stim'],'ident'] == dta[i+o,'resp']) mdl[4] = mdl[4] + 1\t\n\t\tif (1 == dta[i+o,'resp']) mdl[5] = mdl[5] + 1\n\t\tif (2 == dta[i+o,'resp']) mdl[6] = mdl[6] + 1\n\t\tif (3 == dta[i+o,'resp']) mdl[7] = mdl[7] + 1\n\t\tif (0 == dta[i+o,'resp']) tio = tio + 1\n\t}\n\tmdl = mdl / (trls-tio)\n\tbigm[j,'cond'] = dta[o+1,'cond']\n\tbigm[j,'subj'] = dta[o+1,'subj']\n\tbigm[j,3:9] = mdl\n\tbigm[j,'model'] = which.max(mdl)\n\tbigm[j,'consist'] = max(mdl)\n\to = o + trls \n}\nprint(\"Traditional analysis\")\nbigmf <- as.data.frame(bigm)\nprint(\"BC by condition\")\ntdta <- subset(bigmf, cond == 1 | cond == 2, select=c('cond','os','ident'))\nprint(t.test(os ~ cond, data = tdta,var.equal=TRUE))\nprint(\"AB by condition (analysis not reported in paper, but the follow gives the means reported)\")\nprint(t.test(ident ~ cond, data = tdta,var.equal=TRUE))\n\nprint(\"Response-set descriptives - proportions\")\nmbt <- table(bigm[,'cond'],bigm[,'model'])\nud <- mbt[,1] + mbt[,2]\nos <- mbt[,3]\nid <- mbt[,4]\npos <- mbt[,5] # Note, this line only works because there are no left or right key position bias winners.\nmbts <- cbind(ud,os,id)\nmbts[1,] <- mbts[1,]/sum(mbts[1,])\nmbts[2,] <- mbts[2,]/sum(mbts[2,])\nprint(mbts)\n\nprint(\"Response-set analysis\")\nmbts <- cbind(ud,os,id)\nprint(\"UD vs other\")\nc <- rbind(c(mbts[1,'ud'],mbts[1,'os']+mbts[1,'id']),c(mbts[2,'ud'],mbts[2,'os']+mbts[2,'id']))\nprint(chisq.test(c,correct=FALSE)) # Yates correction not used as assumptions of correction not met.\nprint(\"OS vs other\")\nc <- rbind(c(mbts[1,'os'],mbts[1,'ud']+mbts[1,'id']),c(mbts[2,'os'],mbts[2,'ud']+mbts[2,'id']))\nprint(chisq.test(c,simulate.p.value=TRUE)) # Monte Carlo used due to low expected values.\n\n\n#####\n\nprint(\"Save out model summary table, including impulsivity scores\")\nprint(\"This information required for the impulsivity analyses in\")\nprint(\"the Supplementary Materials\")\nbdt <- subset(bigdta, phase == 2)\nkey <- read.table(\"barrattkey.txt\", header = TRUE, sep = \"\\t\")\nsc <- array(0,dim=c(ppts,5))\ncolnames(sc) <- c(\"exp\",\"att\",\"mot\",\"non\",\"bis\")\nfor (cp in 1:ppts) {\n  for (i in 1:30) {\n    for (j in 1:3) {\n      if ( key[i,(j+1)] == 1 ) { \n        sc[cp,(j+1)] <- sc[cp,(j+1)] + bdt[i+(cp-1)*30,'resp']  \n      }\n      if ( key[i,(j+1)] == -1 ) { \n        sc[cp,(j+1)] <- sc[cp,(j+1)] + 5 - bdt[i+(cp-1)*30,'resp']  \n      }\n    }\n  }\n  sc[cp,'bis'] <- sum(sc[cp,2:4])\n}\nbigm <- cbind(bigm,sc)\nbigmf <- as.data.frame(bigm)\nbigmf[,'exp'] <- 'PLYM1'\nsave(bigmf,file='plym1sum.RData')\n\n####\n\nprint(\"SUPPLEMENTARY ANALYSES (RESPONSE SET)\")\n# Removing the position bias people...\nbigm <- bigm[bigm[,'model'] < 5,]\nbigmf <- as.data.frame(bigm)\n# ...and combining the two UD strategies\nbigmf$model[bigmf$model == 1] <- 'ud'\nbigmf$model[bigmf$model == 2] <- 'ud'\nbigmf$model[bigmf$model == 3] <- 'os'\nbigmf$model[bigmf$model == 4] <- 'id'\n# Create a ud column, selecting the better of the two UD fits\nbigmf$ud <- pmax(bigmf$bright,bigmf$size)\n\n# Closest competitor analysis\nbigmf$win.margin <- 0\nfor (i in 1:nrow(bigmf)) {\n  tmp <- c(bigmf[i,'ud'],bigmf[i,'os'],bigmf[i,'ident'])\n  tmp <- tmp[order(tmp)]\n  bigmf$win.margin[i] <- tmp[3] - tmp[2]\n}\n\n#Relabel conditions for ease\nbigmf$cond[bigmf$cond==1] <- '1000 ms'\nbigmf$cond[bigmf$cond==2] <- '5000 ms'\n\nprint('Table S2')\n\nprint('N (all cells)')\nprint(aggregate(consist ~ model + cond,data=bigmf,length))\n\nprint('Consistency (all cells)')\nprint(aggregate(consist ~ model + cond,data=bigmf,mean))\n\nprint('Margin (all cells)')\nprint(aggregate(win.margin ~ model + cond,data=bigmf,mean))\n\nprint('Consistency (collapse condition)')\nprint(aggregate(consist ~ model,data=bigmf,mean))\n\nprint('Margin (collapse condition)')\nprint(aggregate(win.margin ~ model,data=bigmf,mean))\n\nprint('Consistency (collapse models)')\nprint(aggregate(consist ~ cond,data=bigmf,mean))\n\nprint('Margin (collapse models)')\nprint(aggregate(win.margin ~ cond,data=bigmf,mean))\n\nprint('Remove OS (sample too small)')\nbigmfnoos <- bigmf[bigmf$model != 'os',]\n\nprint('Response model type effect on consistency')\nprint(t.test(consist ~ model, data = bigmfnoos,var.equal=TRUE))\n\nprint('Response model type effect on margin')\nprint(t.test(win.margin ~ model, data = bigmfnoos,var.equal=TRUE))\n\nprint('Stimulus presentation time effect on consistency')\nprint(t.test(consist ~ cond, data = bigmf,var.equal=TRUE))\n\nprint('Stimulus presentation time effect on margin')\nprint(t.test(win.margin ~ cond, data = bigmf,var.equal=TRUE))\n\nprint('***END***')\n\n",
    "created" : 1416584754237.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1596771439",
    "id" : "46B2AC2D",
    "lastKnownWriteTime" : 1416521674,
    "path" : "~/Dropbox/PROJECTS/PROJECTS/DAUs/plym3 PLY_4 (Ward triads 2)/plym3willslab/plym1analysis2 copy.R",
    "project_path" : "plym1analysis2 copy.R",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}