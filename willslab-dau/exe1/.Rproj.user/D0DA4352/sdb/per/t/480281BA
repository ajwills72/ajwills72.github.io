{
    "contents" : "cat('DAU: EXE1\\n')\ncat('Author: Andy Wills\\n')\ncat('Date: 2014-11-20\\n')\ncde <- read.table(\"exe1code.txt\", header = TRUE, sep = \"\\t\")\ndta <- read.table(\"exe1data.txt\", header = TRUE, sep = \"\\t\")\n# The raw data file reuses subject numbers across different conditions.\n# This is potentially confusing in some analyses so is fixed here.\ndta$subj[dta$cond == 1024] <- dta$subj[dta$cond == 1024] + 1000 \ndta$subj[dta$cond == 2048] <- dta$subj[dta$cond == 2048] + 2000 \ndta$subj[dta$cond == 3072] <- dta$subj[dta$cond == 3072] + 3000 \ndta$subj[dta$cond == 7500] <- dta$subj[dta$cond == 7500] + 7000 \n# Model-based analysis\nbigm <- array(0, dim=c(145,12))\ncolnames(bigm) <- c(\"cond\",\"subj\",\"hull\",\"sail\",\"os\",\"ident\",\"top1\",\"left2\",\"right3\",\"model\",\"consist\",\"rt\")\no <- 0\nfor (j in 1:145) {\n\tmdl <-c(0,0,0,0,0,0,0)\n\ttio <-0\n\tfor (i in 1:48) { \n\t\tif (cde[dta[i+o,'triad'],'hull'] == dta[i+o,'resp']) mdl[1] = mdl[1] + 1\n\t\tif (cde[dta[i+o,'triad'],'sail'] == dta[i+o,'resp']) mdl[2] = mdl[2] + 1\n\t\tif (cde[dta[i+o,'triad'],'os'] == dta[i+o,'resp']) mdl[3] = mdl[3] + 1\n\t\tif (cde[dta[i+o,'triad'],'ident'] == dta[i+o,'resp']) mdl[4] = mdl[4] + 1\n\t\tif (1 == dta[i+o,'resp']) mdl[5] = mdl[5] + 1\n\t\tif (2 == dta[i+o,'resp']) mdl[6] = mdl[6] + 1\n\t\tif (3 == dta[i+o,'resp']) mdl[7] = mdl[7] + 1\n\t\tif (0 == dta[i+o,'resp']) tio = tio + 1\n\t}\n\tmdl = mdl / (48-tio)\n\tbigm[j,'cond'] = dta[o+1,'cond']\n\tbigm[j,'subj'] = dta[o+2,'subj']\n\tbigm[j,3:9] = mdl\n\tbigm[j,'model'] = which.max(mdl)\n\tbigm[j,'consist'] = max(mdl)\n\tbigm[j,'rt'] = sum(dta[(1+o):(48+o),'rt']) / (48-tio)\n\to = o + 48\n}\n\ncat('Traditional descriptives (For model consistency, see later)\\n')\ncat('The rows OS and IDENT correspond to the OS and ID values reported in Table 2\\n')\nlibrary(psych)\nbigmf <- as.data.frame(bigm)\nprint(describeBy(bigmf,bigmf$cond))\n\ncat('Model-based desciptives\\n')\nmbt <- table(bigm[,'cond'],bigm[,'model'])\nud <- mbt[,1] + mbt[,2]\nos <- mbt[,3]\nid <- mbt[,4]\npos <- mbt[,5] + mbt[,6] + mbt[,7]\nmbts <- cbind(ud,os,id)\nmbts[1,] <- mbts[1,]/sum(mbts[1,])\nmbts[2,] <- mbts[2,]/sum(mbts[2,])\nmbts[3,] <- mbts[3,]/sum(mbts[3,])\nmbts[4,] <- mbts[4,]/sum(mbts[4,])\nmbts[5,] <- mbts[5,]/sum(mbts[5,])\nprint(mbts)\nprint('Traditional analysis Part 1')\nprint('1024ms vs 3072ms t-test')\ntdta <- subset(bigmf, cond == 1024 | cond == 3072, select=c('cond','os','ident'))\nprint(t.test(os ~ cond, data = tdta,var.equal=TRUE))\nprint('1024ms vs 7500ms t-test')\ntdta <- subset(bigmf, cond == 1024 | cond == 7500, select=c('cond','os','ident'))\nprint(t.test(os ~ cond, data = tdta,var.equal=TRUE))\nprint('1024ms vs 2048ms t-test')\ntdta <- subset(bigmf, cond == 1024 | cond == 2048, select=c('cond','os','ident'))\nprint(t.test(os ~ cond, data = tdta,var.equal=TRUE))\nprint('3072 ms vs 7500 ms t-test')\ntdta <- subset(bigmf, cond == 3072 | cond == 7500, select=c('cond','os','ident'))\nprint(t.test(os ~ cond, data = tdta,var.equal=TRUE))\n\nprint('Model-based analysis Part 1')\nmbts <- cbind(ud,os,id)\n\nprint('1024ms vs 3072ms UD vs other.')\nc <- rbind(c(mbts['1024','ud'],mbts['1024','os']+mbts['1024','id']),c(mbts['3072','ud'],mbts['3072','os']+mbts['3072','id']))\nprint(chisq.test(c,correct=FALSE))\n\nprint('1024ms vs 7500ms UD vs other.')\nc <- rbind(c(mbts['1024','ud'],mbts['1024','os']+mbts['1024','id']),c(mbts['7500','ud'],mbts['7500','os']+mbts['7500','id']))\nprint(chisq.test(c,correct=FALSE))\n\nprint('1024ms vs 3072ms OS vs other.')\nc <- rbind(c(mbts['1024','os'],mbts['1024','ud']+mbts['1024','id']),c(mbts['3072','os'],mbts['3072','ud']+mbts['3072','id']))\nprint(chisq.test(c,correct=FALSE))\n\nprint('1024ms vs 2048ms OS vs other.')\nc <- rbind(c(mbts['1024','os'],mbts['1024','ud']+mbts['1024','id']),c(mbts['2048','os'],mbts['2048','ud']+mbts['2048','id']))\nprint(chisq.test(c,correct=FALSE))\n\nprint('1024ms vs 7500ms OS vs other.')\nc <- rbind(c(mbts['1024','os'],mbts['1024','ud']+mbts['1024','id']),c(mbts['7500','os'],mbts['7500','ud']+mbts['7500','id']))\nprint(chisq.test(c,correct=FALSE))\n\nprint('3072ms vs 2048ms OS vs other.')\nc <- rbind(c(mbts['3072','os'],mbts['3072','ud']+mbts['3072','id']),c(mbts['2048','os'],mbts['2048','ud']+mbts['2048','id']))\nprint(chisq.test(c,simulate.p.value=TRUE))\n\nprint(\"SUPPLEMENTARY ANALYSES (RESPONSE SET)\")\n\n# Look at consistency, removing the position bias people...\nbigm <- bigm[bigm[,'model'] < 5,]\nbigmf <- as.data.frame(bigm)\n# ...and combining the two UD strategies\nbigmf$model[bigmf$model == 1] <- 'ud'\nbigmf$model[bigmf$model == 2] <- 'ud'\nbigmf$model[bigmf$model == 3] <- 'os'\nbigmf$model[bigmf$model == 4] <- 'id'\n# Create a ud column, selecting the better of the two UD fits\nbigmf$ud <- pmax(bigmf$hull,bigmf$sail)\n# Closest competitor analysis\nbigmf$win.margin <- 0\nfor (i in 1:nrow(bigmf)) {\n  tmp <- c(bigmf[i,'ud'],bigmf[i,'os'],bigmf[i,'ident'])\n  tmp <- tmp[order(tmp)]\n  bigmf$win.margin[i] <- tmp[3] - tmp[2]\n}\n\nprint('Table S1')\n\nprint('N (all cells)')\nprint(aggregate(consist ~ model + cond,data=bigmf,length))\n\nprint('Consistency (all cells)')\nprint(aggregate(consist ~ model + cond,data=bigmf,mean))\n\nprint('Consistency (collapse models)')\nprint(aggregate(consist ~ cond,data=bigmf,mean))\n\nprint('Consistency (collapse condition)')\nprint(aggregate(consist ~ model,data=bigmf,mean))\n\nprint('Margin (all cells)')\nprint(aggregate(win.margin ~ model + cond,data=bigmf,mean))\n\nprint('Margin (collapse models)')\nprint(aggregate(win.margin ~ cond,data=bigmf,mean))\n\nprint('Margin (collapse condition)')\nprint(aggregate(win.margin ~ model,data=bigmf,mean))\n\nprint('Response model type effect on consistency')\na1 <- aov(consist ~ model, data = bigmf)\nprint(summary(a1))\nprint(TukeyHSD(a1))\n\nprint('Response model type effect on margin')\na1 <- aov(win.margin ~ model, data = bigmf)\nprint(summary(a1))\nprint(TukeyHSD(a1))\n\nprint('Stimulus presentation time effect on consistency')\nag <- aggregate(consist ~ cond,data=bigmf,mean)\nlin.mod <- lm(consist ~ cond, data = ag)\nprint(summary(lin.mod))\n\nprint('Stimulus presentation time effect on margin')\nag <- aggregate(consist ~ cond,data=bigmf,mean)\nlin.mod <- lm(consist ~ cond, data = ag)\nprint(summary(lin.mod))\n\nprint('Save out model analysis')\nbigmf[,'exp'] <- 'EXE1'\nsave(bigmf,file='exe1sum2.RData')\n\nprint('***END***')\n",
    "created" : 1416517477066.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "4069834349",
    "id" : "480281BA",
    "lastKnownWriteTime" : 1416586893,
    "path" : "~/Dropbox/PROJECTS/PROJECTS/DAUs/EXE1-2006-001 Milton et al 2008 Experiment 5/exe1willslab/exe1analysis2.R",
    "project_path" : "exe1analysis2.R",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}