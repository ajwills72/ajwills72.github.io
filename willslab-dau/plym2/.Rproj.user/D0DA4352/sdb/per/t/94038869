{
    "contents" : "print(\"DAU: PLYM2\")\nprint(\"Author: Andy Wills\")\nprint(\"Date: 2014-11-21\")\nlibrary(psych)\ncde <- read.table(\"plym2code.txt\", header = TRUE, sep = \"\\t\")\nbigdta <- read.table(\"plym2data.txt\", header = TRUE, sep = \"\\t\")\ndta <- subset(bigdta, phase == 1)\nppts <- 107\ntrls <- 96\nprint(\"Preparing response set analysis...\")\nbigm <- array(0, dim=c(ppts,12))\ncolnames(bigm) <- c(\"cond\",\"subj\",\"dot\",\"leng\",\"os\",\"ident\",\"left1\",\"mid2\",\"right3\",\"nbr\",\"model\",\"consist\")\no <- 0\nfor (j in 1:ppts) {\n\tmdl <-c(0,0,0,0,0,0,0,0)\n\ttio <-0\n\tfor (i in 1:trls) { \n\t\tif (cde[dta[i+o,'stim'],'dot'] == dta[i+o,'resp']) mdl[1] = mdl[1] + 1\n\t\tif (cde[dta[i+o,'stim'],'leng'] == dta[i+o,'resp']) mdl[2] = mdl[2] + 1\n\t\tif (cde[dta[i+o,'stim'],'os'] == dta[i+o,'resp']) mdl[3] = mdl[3] + 1\n\t\tif (cde[dta[i+o,'stim'],'ident'] == dta[i+o,'resp']) mdl[4] = mdl[4] + 1\t\n\t\tif (1 == dta[i+o,'resp']) mdl[5] = mdl[5] + 1\n\t\tif (2 == dta[i+o,'resp']) mdl[6] = mdl[6] + 1\n\t\tif (3 == dta[i+o,'resp']) mdl[7] = mdl[7] + 1\n\t\tif (cde[dta[i+o,'stim'],'nbr'] == dta[i+o,'resp']) mdl[8] = mdl[8] + 1\t\n\t\tif (0 == dta[i+o,'resp']) tio = tio + 1\n\t}\n\tmdl = mdl / (trls-tio)\n\tbigm[j,'cond'] = dta[o+1,'cond']\n\tbigm[j,'subj'] = dta[o+1,'subj']\n\tbigm[j,3:10] = mdl\n\tbigm[j,'model'] = which.max(mdl)\n\tbigm[j,'consist'] = max(mdl)\n\to = o + trls \n}\nprint(\"Traditional analysis\")\nbigmf <- as.data.frame(bigm)\ntdta <- subset(bigmf, cond == 1 | cond == 2, select=c('cond','os','ident'))\nprint(\"BC proportion by condition\")\nprint(t.test(os ~ cond, data = tdta,var.equal=TRUE))\nprint(\"AB proportion by condition (paper reports means by not t-test\")\nprint(t.test(ident ~ cond, data = tdta,var.equal=TRUE))\n\n\nprint(\"Response-set descriptives - proportions\")\nmbt <- table(bigm[,'cond'],bigm[,'model'])\nud <- mbt[,1] + mbt[,2]\nos <- mbt[,3]\nid <- mbt[,4]\nmbts <- cbind(ud,os,id)\nmbts[1,] <- mbts[1,]/sum(mbts[1,])\nmbts[2,] <- mbts[2,]/sum(mbts[2,])\nprint(mbts)\n\nprint(\"Response-set analysis\")\nmbts <- cbind(ud,os,id)\nprint(\"OS vs other\")\nc <- rbind(c(mbts[1,'os'],mbts[1,'ud']+mbts[1,'id']),c(mbts[2,'os'],mbts[2,'ud']+mbts[2,'id']))\nprint(chisq.test(c,correct=FALSE)) # Monte Carlo used due to low expected values.\n\nprint(\"UD vs other\")\nc <- rbind(c(mbts[1,'ud'],mbts[1,'os']+mbts[1,'id']),c(mbts[2,'ud'],mbts[2,'os']+mbts[2,'id']))\nprint(chisq.test(c,correct=FALSE)) # Yates correction not used as assumptions of correction not met.\n\nprint(\"Save out model summary table, including impulsivity scores\")\nbdt <- subset(bigdta, phase == 2)\nkey <- read.table(\"barrattkey.txt\", header = TRUE, sep = \"\\t\")\nsc <- array(0,dim=c(ppts,5))\ncolnames(sc) <- c(\"exp\",\"att\",\"mot\",\"non\",\"bis\")\nfor (cp in 1:ppts) {\n  for (i in 1:30) {\n    for (j in 1:3) {\n      if ( key[i,(j+1)] == 1 ) { \n        sc[cp,(j+1)] <- sc[cp,(j+1)] + bdt[i+(cp-1)*30,'resp']  \n      }\n      if ( key[i,(j+1)] == -1 ) { \n        sc[cp,(j+1)] <- sc[cp,(j+1)] + 5 - bdt[i+(cp-1)*30,'resp']  \n      }\n    }\n  }\n  sc[cp,'bis'] <- sum(sc[cp,2:4])\n}\nbigm <- cbind(bigm,sc)\nbigmf <- as.data.frame(bigm)\nbigmf[,'exp'] <- 'PLYM2'\nsave(bigmf,file='plym2sum.RData')\n\n####\n\nprint(\"SUPPLEMENTARY ANALYSES (RESPONSE SET)\")\n# Removing the position bias people...\nbigm <- bigm[bigm[,'model'] < 5,]\nbigmf <- as.data.frame(bigm)\n# ...and combining the two UD strategies\nbigmf$model[bigmf$model == 1] <- 'ud'\nbigmf$model[bigmf$model == 2] <- 'ud'\nbigmf$model[bigmf$model == 3] <- 'os'\nbigmf$model[bigmf$model == 4] <- 'id'\n# Create a ud column, selecting the better of the two UD fits\nbigmf$ud <- pmax(bigmf$dot,bigmf$leng)\n\n# Closest competitor analysis\nbigmf$win.margin <- 0\nfor (i in 1:nrow(bigmf)) {\n  tmp <- c(bigmf[i,'ud'],bigmf[i,'os'],bigmf[i,'ident'])\n  tmp <- tmp[order(tmp)]\n  bigmf$win.margin[i] <- tmp[3] - tmp[2]\n}\n\n#Relabel conditions for ease\nbigmf$cond[bigmf$cond==1] <- '2000 ms'\nbigmf$cond[bigmf$cond==2] <- '5000 ms'\n\nprint('Table S3')\n\nprint('N (all cells)')\nprint(aggregate(consist ~ model + cond,data=bigmf,length))\n\nprint('Consistency (all cells)')\nprint(aggregate(consist ~ model + cond,data=bigmf,mean))\n\nprint('Margin (all cells)')\nprint(aggregate(win.margin ~ model + cond,data=bigmf,mean))\n\nprint('Consistency (collapse condition)')\nprint(aggregate(consist ~ model,data=bigmf,mean))\n\nprint('Margin (collapse condition)')\nprint(aggregate(win.margin ~ model,data=bigmf,mean))\n\nprint('Consistency (collapse models)')\nprint(aggregate(consist ~ cond,data=bigmf,mean))\n\nprint('Margin (collapse models)')\nprint(aggregate(win.margin ~ cond,data=bigmf,mean))\n\nprint('Response model type effect on consistency')\na1 <- aov(consist ~ model, data = bigmf)\nprint(summary(a1))\n\nprint('Response model type effect on margin')\na1 <- aov(win.margin ~ model, data = bigmf)\nprint(summary(a1))\nprint(TukeyHSD(a1))\n\nprint('Stimulus presentation time effect on consistency')\nprint(t.test(consist ~ cond, data = bigmf,var.equal=TRUE))\n\nprint('Stimulus presentation time effect on margin')\nprint(t.test(win.margin ~ cond, data = bigmf,var.equal=TRUE))\n\nprint('Remove ID for interaction test (sample too small)')\nbigmfnoid <- bigmf[bigmf$model != 'id',]\n\nlibrary(ez)\n\nprint(\"Interaction analysis (consistency) \")\neza <- ezANOVA( data = bigmfnoid\n                , dv = consist\n                , wid = subj\n                , between = c('cond','model')\n                , type = 3)\nprint(eza)\n\nprint(\"Interaction analysis (margin) \")\neza <- ezANOVA( data = bigmfnoid\n                , dv = win.margin\n                , wid = subj\n                , between = c('cond','model')\n                , type = 3)\nprint(eza)\n\nprint('Save out model analysis')\nbigmf[,'exp'] <- 'PLYM2'\nsave(bigmf,file='plym2sum2.RData')\n\nprint('***END***')\n\n\n",
    "created" : 1401445558087.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2552142903",
    "id" : "94038869",
    "lastKnownWriteTime" : 1416586854,
    "path" : "~/Dropbox/PROJECTS/PROJECTS/DAUs/plym2 PLY_1 (Ward triads)/plym2willslab/plym2analysis.R",
    "project_path" : "plym2analysis.R",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}