{
    "contents" : "print(\"PLYM5 - Logistic regression\")\nprint(\"Author: Andy Wills\")\nprint(\"Date: 2014-12-04\")\n\n# Define custom function\nfeatcon <- function(dataset) {\n  require(logistf)\n  firth.model <- logistf(resp ~ ca + nca1 + nca2 + nca3 + ca,data=dataset)\n  resul <- c(firth.model$coeff,firth.model$prob)\n  names(resul) <- c('intercept.coef','ca.coef','nca1.coef','nca2.coef','nca3.coef','intercept.p','ca.p','nca1.p','nca2.p','nca3.p')\n  return(resul)  \n}\n\n# Load data file and decode file\ncode <- read.table(\"plym5code.txt\", header = TRUE, sep = \"\\t\",stringsAsFactors = FALSE,row.names=NULL)\ndta <- read.table(\"plym5data.txt\", header = TRUE, sep = \"\\t\")\n\n# Add stimulus dimensions to data file.\ndecode <- code[dta$stim,4:7]\ndta <- cbind(dta,decode)\ntstdta <- dta[dta$phase==2,]\nrm(dta,decode,code)\n\n# Name conditions for readability\ntstdta$cond[tstdta$cond == 1] <- 'intentional'\ntstdta$cond[tstdta$cond == 2] <- 'incidental'\n\n# Run through subjects\nsubjs <- as.numeric(levels(as.factor(tstdta$subj)))\nresults <- array(0,dim=c(length(subjs),18))\nresults <- data.frame(results)\ncolnames(results) <- c('subj','cond','ndim','intercept.coef','ca.coef','nca1.coef','nca2.coef','nca3.coef',\n                       'intercept.p','ca.p','nca1.p','nca2.p','nca3.p','coef4','coef3','coef2','coef1','strongca')\ni <- 0\nfor(subindex in subjs) {\n  i <- i + 1\n  onesub <- tstdta[tstdta$subj == subindex,]\n  results[i,1] <- subindex\n  results[i,4:13] <- featcon(onesub)\n  results[i,3] <- sum(results[i,10:13] < .05) # This counts number of features where p < .05\n  tmp <- results[i,5:8]\n  results[i,14:17] <- tmp[order(abs(tmp))]\n  if (results[i,5] == results[i,17]) results[i,18] <- 1 # Is strongest dimension criterial?\n  results[i,2] <- onesub$cond[1] \n}\n\n# Remove those with no dimensions controlling behavior\nresults <- results[results$ndim != 0,]\n\nprint('Dimensions DV descriptives')\ntbl <- table(results$ndim,results$cond)\nprops <- tbl\nprops[,1] <- props[,1]/sum(props[,1])\nprops[,2] <- props[,2]/sum(props[,2])\nprint(props)\n\nprint('Criterial DV descriptives')\ncrit <- table(results$strongca,results$cond)\nrownames(crit) <- c('NCA','CA')\ncritprops <- crit\ncritprops[,1] <- critprops[,1]/sum(critprops[,1])\ncritprops[,2] <- critprops[,2]/sum(critprops[,2])\nprint(critprops)\n\nprint('Criterial DV chi-square test')\nprint(chisq.test(crit,correct=FALSE))\n\nprint('Dimensions DV chi-square test')\nprint(chisq.test(tbl,simulate.p.value=TRUE, B = 200000))\n\nprint('Dimensions DV Bayesian contingency table')\nlibrary(conting)\n#Reshape data\ny <- c(tbl[,1],tbl[,2])\ncond <- c(rep('incidental',4),rep('intentional',4))\nndim <- c(rep(c(1,2,3,4),2))\nmb <- data.frame(cond,ndim,y)\n\nprint(\"MC methods, 10k iterations (not stable with fewer)\")\ntest <- bcct(formula=y~(ndim+cond)^2,data=mb,n.sample=10000,prior=\"UIP\")\n#summary(test)\nprint(\"Bayes Factor\")\nprint(.15/.85) # Done manually for simplicity (could read test structure directly)\n",
    "created" : 1417708767759.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2831333242",
    "id" : "6AAFAD53",
    "lastKnownWriteTime" : 1417709269,
    "path" : "~/Dropbox/PROJECTS/PROJECTS/DAUs/plym5 PLY_7 (KN84)/plym5willslab/plym5logistic.R",
    "project_path" : "plym5logistic.R",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}